

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Recommender algorithms module &#8212; Recommenders documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="_static/tabs.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'models';</script>
    <link rel="canonical" href="https://recommenders-team.github.io/recommenders/models.html" />
    <link rel="shortcut icon" href="https://raw.githubusercontent.com/recommenders-team/artwork/main/icon/recommenders_color_icon.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Hyperparameter tuning module" href="tuning.html" />
    <link rel="prev" title="Evaluation module" href="evaluation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="https://raw.githubusercontent.com/recommenders-team/artwork/main/color/recommenders_color.svg" class="logo__image only-light" alt="Recommenders documentation - Home"/>
    <script>document.write(`<img src="https://raw.githubusercontent.com/recommenders-team/artwork/main/color/recommenders_color.svg" class="logo__image only-dark" alt="Recommenders documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Recommenders API Documentation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Dataset module</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluation.html">Evaluation module</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Recommender algorithms module</a></li>
<li class="toctree-l1"><a class="reference internal" href="tuning.html">Hyperparameter tuning module</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Common utilities module</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/recommenders-team/recommenders" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/recommenders-team/recommenders/issues/new?title=Issue%20on%20page%20%2Fmodels.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/models.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Recommender algorithms module</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.cornac.cornac_utils">Cornac</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deeprec">DeepRec</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#base-model">Base model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dkn">DKN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dkn-item-to-item">DKN item-to-item</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xdeepfm">xDeepFM</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lightgcn">LightGCN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sequential-models">Sequential models</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sequential-base-model">Sequential base model</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a2svd">A2SVD</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#caser">Caser</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gru">GRU</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nextitnet">NextItNet</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#rnn-cells">RNN Cells</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sum">SUM</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#slirec">SLIRec</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iterators">Iterators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.DataModel.ImplicitCF">Data processing utilities</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.deeprec_utils">Utilities</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fastai">FastAI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.geoimc.geoimc_data">GeoIMC</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.lightfm.lightfm_utils">LightFM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.lightgbm.lightgbm_utils">LightGBM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.ncf.dataset">NCF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.newsrec.newsrec_utils">NewsRec</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rbm">RBM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.rlrmc.RLRMCdataset">RLRMC</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.sar.sar_singlenode">SAR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.sasrec.sampler">SASRec</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sse-pt">SSE-PT</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.surprise.surprise_utils">Surprise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.tfidf.tfidf_utils">TF-IDF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vae">VAE</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.vowpal_wabbit.vw">Vowpal Wabbit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wide-deep">Wide &amp; Deep</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="recommender-algorithms-module">
<span id="recommender"></span><h1>Recommender algorithms module<a class="headerlink" href="#recommender-algorithms-module" title="Permalink to this heading">#</a></h1>
<p>Recommender system algorithms and utilities.</p>
<section id="module-recommenders.models.cornac.cornac_utils">
<span id="cornac"></span><h2>Cornac<a class="headerlink" href="#module-recommenders.models.cornac.cornac_utils" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.cornac.cornac_utils.predict">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.cornac.cornac_utils.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usercol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/cornac/cornac_utils.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.cornac.cornac_utils.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Computes predictions of a recommender model from Cornac on the data.
Can be used for computing rating metrics like RMSE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>cornac.models.Recommender</em>) – A recommender model from Cornac</p></li>
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – The data on which to predict</p></li>
<li><p><strong>usercol</strong> (<em>str</em>) – Name of the user column</p></li>
<li><p><strong>itemcol</strong> (<em>str</em>) – Name of the item column</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with usercol, itemcol, predcol</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.cornac.cornac_utils.predict_ranking">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.cornac.cornac_utils.</span></span><span class="sig-name descname"><span class="pre">predict_ranking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usercol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/cornac/cornac_utils.html#predict_ranking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.cornac.cornac_utils.predict_ranking" title="Permalink to this definition">#</a></dt>
<dd><p>Computes predictions of recommender model from Cornac on all users and items in data.
It can be used for computing ranking metrics like NDCG.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>cornac.models.Recommender</em>) – A recommender model from Cornac</p></li>
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – The data from which to get the users and items</p></li>
<li><p><strong>usercol</strong> (<em>str</em>) – Name of the user column</p></li>
<li><p><strong>itemcol</strong> (<em>str</em>) – Name of the item column</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – Flag to remove (user, item) pairs seen in the training data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with usercol, itemcol, predcol</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="deeprec">
<h2>DeepRec<a class="headerlink" href="#deeprec" title="Permalink to this heading">#</a></h2>
<section id="base-model">
<h3>Base model<a class="headerlink" href="#base-model" title="Permalink to this heading">#</a></h3>
</section>
<section id="dkn">
<h3>DKN<a class="headerlink" href="#dkn" title="Permalink to this heading">#</a></h3>
</section>
<section id="dkn-item-to-item">
<h3>DKN item-to-item<a class="headerlink" href="#dkn-item-to-item" title="Permalink to this heading">#</a></h3>
</section>
<section id="xdeepfm">
<h3>xDeepFM<a class="headerlink" href="#xdeepfm" title="Permalink to this heading">#</a></h3>
</section>
<section id="lightgcn">
<h3>LightGCN<a class="headerlink" href="#lightgcn" title="Permalink to this heading">#</a></h3>
</section>
<section id="sequential-models">
<h3>Sequential models<a class="headerlink" href="#sequential-models" title="Permalink to this heading">#</a></h3>
<section id="sequential-base-model">
<h4>Sequential base model<a class="headerlink" href="#sequential-base-model" title="Permalink to this heading">#</a></h4>
</section>
<section id="a2svd">
<h4>A2SVD<a class="headerlink" href="#a2svd" title="Permalink to this heading">#</a></h4>
</section>
<section id="caser">
<h4>Caser<a class="headerlink" href="#caser" title="Permalink to this heading">#</a></h4>
</section>
<section id="gru">
<h4>GRU<a class="headerlink" href="#gru" title="Permalink to this heading">#</a></h4>
</section>
<section id="nextitnet">
<h4>NextItNet<a class="headerlink" href="#nextitnet" title="Permalink to this heading">#</a></h4>
</section>
<section id="rnn-cells">
<h4>RNN Cells<a class="headerlink" href="#rnn-cells" title="Permalink to this heading">#</a></h4>
</section>
<section id="sum">
<h4>SUM<a class="headerlink" href="#sum" title="Permalink to this heading">#</a></h4>
</section>
<section id="slirec">
<h4>SLIRec<a class="headerlink" href="#slirec" title="Permalink to this heading">#</a></h4>
</section>
</section>
<section id="iterators">
<h3>Iterators<a class="headerlink" href="#iterators" title="Permalink to this heading">#</a></h3>
</section>
<section id="module-recommenders.models.deeprec.DataModel.ImplicitCF">
<span id="data-processing-utilities"></span><h3>Data processing utilities<a class="headerlink" href="#module-recommenders.models.deeprec.DataModel.ImplicitCF" title="Permalink to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.DataModel.ImplicitCF.</span></span><span class="sig-name descname"><span class="pre">ImplicitCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_prediction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/DataModel/ImplicitCF.html#ImplicitCF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF" title="Permalink to this definition">#</a></dt>
<dd><p>Data processing class for GCN models which use implicit feedback.</p>
<p>Initialize train and test set, create normalized adjacency matrix and sample data for training epochs.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adj_dir</strong> (<em>str</em>) – Directory to save / load adjacency matrices. If it is None, adjacency
matrices will be created and will not be saved.</p></li>
<li><p><strong>train</strong> (<em>pandas.DataFrame</em>) – Training data with at least columns (col_user, col_item, col_rating).</p></li>
<li><p><strong>test</strong> (<em>pandas.DataFrame</em>) – Test data with at least columns (col_user, col_item, col_rating).
test can be None, if so, we only process the training data.</p></li>
<li><p><strong>col_user</strong> (<em>str</em>) – User column name.</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – Item column name.</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – Rating column name.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.create_norm_adj_mat">
<span class="sig-name descname"><span class="pre">create_norm_adj_mat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/DataModel/ImplicitCF.html#ImplicitCF.create_norm_adj_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.create_norm_adj_mat" title="Permalink to this definition">#</a></dt>
<dd><p>Create normalized adjacency matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Normalized adjacency matrix.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scipy.sparse.csr_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.get_norm_adj_mat">
<span class="sig-name descname"><span class="pre">get_norm_adj_mat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/DataModel/ImplicitCF.html#ImplicitCF.get_norm_adj_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.get_norm_adj_mat" title="Permalink to this definition">#</a></dt>
<dd><p>Load normalized adjacency matrix if it exists, otherwise create (and save) it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Normalized adjacency matrix.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scipy.sparse.csr_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.train_loader">
<span class="sig-name descname"><span class="pre">train_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/DataModel/ImplicitCF.html#ImplicitCF.train_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.train_loader" title="Permalink to this definition">#</a></dt>
<dd><p>Sample train data every batch. One positive item and one negative item sampled for each user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_size</strong> (<em>int</em>) – Batch size of users.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Sampled users.</p></li>
<li><p>Sampled positive items.</p></li>
<li><p>Sampled negative items.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray, numpy.ndarray, numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.deeprec.deeprec_utils">
<span id="utilities"></span><h3>Utilities<a class="headerlink" href="#module-recommenders.models.deeprec.deeprec_utils" title="Permalink to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.HParams">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">HParams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#HParams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.HParams" title="Permalink to this definition">#</a></dt>
<dd><p>Class for holding hyperparameters for DeepRec algorithms.</p>
<p>Create an HParams object from a dictionary of hyperparameter values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hparams_dict</strong> (<em>dict</em>) – Dictionary with the model hyperparameters.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.HParams.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#HParams.values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.HParams.values" title="Permalink to this definition">#</a></dt>
<dd><p>Return the hyperparameter values as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary with the hyperparameter values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.cal_metric">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">cal_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#cal_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.cal_metric" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate metrics.</p>
<p>Available options are: <cite>auc</cite>, <cite>rmse</cite>, <cite>logloss</cite>, <cite>acc</cite> (accurary), <cite>f1</cite>, <cite>mean_mrr</cite>,
<cite>ndcg</cite> (format like: ndcg&#64;2;4;6;8), <cite>hit</cite> (format like: hit&#64;2;4;6;8), <cite>group_auc</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<em>array-like</em>) – Labels.</p></li>
<li><p><strong>preds</strong> (<em>array-like</em>) – Predictions.</p></li>
<li><p><strong>metrics</strong> (<em>list</em>) – List of metric names.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cal_metric</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;ndcg@2;4;6&quot;</span><span class="p">,</span> <span class="s2">&quot;group_auc&quot;</span><span class="p">])</span>
<span class="go">{&#39;ndcg@2&#39;: 0.4026, &#39;ndcg@4&#39;: 0.4953, &#39;ndcg@6&#39;: 0.5346, &#39;group_auc&#39;: 0.8096}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.check_nn_config">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">check_nn_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#check_nn_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.check_nn_config" title="Permalink to this definition">#</a></dt>
<dd><p>Check neural networks configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f_config</strong> (<em>dict</em>) – Neural network configuration.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the parameters are not correct.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.check_type">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">check_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#check_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.check_type" title="Permalink to this definition">#</a></dt>
<dd><p>Check that the config parameters are the correct type</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Configuration dictionary.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – If the parameters are not the correct type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.create_hparams">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">create_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#create_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.create_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Create the model hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>flags</strong> (<em>dict</em>) – Dictionary with the model requirements.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hyperparameter object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#recommenders.models.deeprec.deeprec_utils.HParams" title="recommenders.models.deeprec.deeprec_utils.HParams">HParams</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.dcg_score">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">dcg_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#dcg_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.dcg_score" title="Permalink to this definition">#</a></dt>
<dd><p>Computing dcg score metric at k.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.ndarray</em>) – Ground-truth labels.</p></li>
<li><p><strong>y_score</strong> (<em>np.ndarray</em>) – Predicted labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dcg scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.download_deeprec_resources">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">download_deeprec_resources</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">azure_container_url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remote_resource_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#download_deeprec_resources"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.download_deeprec_resources" title="Permalink to this definition">#</a></dt>
<dd><p>Download resources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>azure_container_url</strong> (<em>str</em>) – URL of Azure container.</p></li>
<li><p><strong>data_path</strong> (<em>str</em>) – Path to download the resources.</p></li>
<li><p><strong>remote_resource_name</strong> (<em>str</em>) – Name of the resource.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.flat_config">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">flat_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#flat_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.flat_config" title="Permalink to this definition">#</a></dt>
<dd><p>Flat config loaded from a yaml file to a flat dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Configuration loaded from a yaml file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configuration dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.hit_score">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">hit_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#hit_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.hit_score" title="Permalink to this definition">#</a></dt>
<dd><p>Computing hit score metric at k.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.ndarray</em>) – ground-truth labels.</p></li>
<li><p><strong>y_score</strong> (<em>np.ndarray</em>) – predicted labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>hit score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.load_dict">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">load_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#load_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.load_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Load the vocabularies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Filename of user, item or category vocabulary.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A saved vocabulary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.load_yaml">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">load_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#load_yaml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.load_yaml" title="Permalink to this definition">#</a></dt>
<dd><p>Load a yaml file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Filename.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.mrr_score">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">mrr_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_score</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#mrr_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.mrr_score" title="Permalink to this definition">#</a></dt>
<dd><p>Computing mrr score metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.ndarray</em>) – Ground-truth labels.</p></li>
<li><p><strong>y_score</strong> (<em>np.ndarray</em>) – Predicted labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>mrr scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.ndcg_score">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">ndcg_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#ndcg_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.ndcg_score" title="Permalink to this definition">#</a></dt>
<dd><p>Computing ndcg score metric at k.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.ndarray</em>) – Ground-truth labels.</p></li>
<li><p><strong>y_score</strong> (<em>np.ndarray</em>) – Predicted labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ndcg scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.prepare_hparams">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">prepare_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yaml_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/deeprec/deeprec_utils.html#prepare_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.prepare_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the model hyperparameters and check that all have the correct value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>yaml_file</strong> (<em>str</em>) – YAML file as configuration.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hyperparameter object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#recommenders.models.deeprec.deeprec_utils.HParams" title="recommenders.models.deeprec.deeprec_utils.HParams">HParams</a></p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="fastai">
<h2>FastAI<a class="headerlink" href="#fastai" title="Permalink to this heading">#</a></h2>
</section>
<section id="module-recommenders.models.geoimc.geoimc_data">
<span id="geoimc"></span><h2>GeoIMC<a class="headerlink" href="#module-recommenders.models.geoimc.geoimc_data" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.DataPtr">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_data.</span></span><span class="sig-name descname"><span class="pre">DataPtr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entities</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_data.html#DataPtr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.DataPtr" title="Permalink to this definition">#</a></dt>
<dd><p>Holds data and its respective indices</p>
<p>Initialize a data pointer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>csr_matrix</em>) – The target data matrix.</p></li>
<li><p><strong>entities</strong> (<em>Iterator</em>) – An iterator (of 2 elements (ndarray)) containing</p></li>
<li><p><strong>row</strong> (<em>the features of</em>) – </p></li>
<li><p><strong>entities.</strong> (<em>col</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.DataPtr.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_data.html#DataPtr.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.DataPtr.get_data" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Target matrix (based on the data_indices filter)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>csr_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.DataPtr.get_entity">
<span class="sig-name descname"><span class="pre">get_entity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">of</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'row'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_data.html#DataPtr.get_entity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.DataPtr.get_entity" title="Permalink to this definition">#</a></dt>
<dd><p>Get entity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>of</strong> (<em>str</em>) – The entity, either ‘row’ or ‘col’</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Entity matrix (based on the entity_indices filter)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.Dataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_data.</span></span><span class="sig-name descname"><span class="pre">Dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_data.html#Dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.Dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Base class that holds necessary (minimal) information needed</p>
<p>Initialize parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name of the dataset</p></li>
<li><p><strong>features_dim</strong> (<em>uint</em>) – Dimension of the features. If not 0, PCA is performed
on the features as the dimensionality reduction technique</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – Normalize the features</p></li>
<li><p><strong>target_transform</strong> (<em>str</em>) – Transform the target values. Current options are
‘normalize’ (Normalize the values), ‘’ (Do nothing), ‘binarize’ (convert
the values using a threshold defined per dataset)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.Dataset.generate_train_test_data">
<span class="sig-name descname"><span class="pre">generate_train_test_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_data.html#Dataset.generate_train_test_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.Dataset.generate_train_test_data" title="Permalink to this definition">#</a></dt>
<dd><p>Generate train, test split. The split is performed on the row
entities. So, this essentially becomes a cold start row entity test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>csr_matrix</em>) – The entire target matrix.</p></li>
<li><p><strong>test_ratio</strong> (<em>float</em>) – Ratio of test split.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.Dataset.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_data.html#Dataset.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.Dataset.normalize" title="Permalink to this definition">#</a></dt>
<dd><p>Normalizes the entity features</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.Dataset.reduce_dims">
<span class="sig-name descname"><span class="pre">reduce_dims</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_data.html#Dataset.reduce_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.Dataset.reduce_dims" title="Permalink to this definition">#</a></dt>
<dd><p>Reduces the dimensionality of entity features.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.ML_100K">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_data.</span></span><span class="sig-name descname"><span class="pre">ML_100K</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_data.html#ML_100K"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.ML_100K" title="Permalink to this definition">#</a></dt>
<dd><p>Handles MovieLens-100K</p>
<p>Initialize parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name of the dataset</p></li>
<li><p><strong>features_dim</strong> (<em>uint</em>) – Dimension of the features. If not 0, PCA is performed
on the features as the dimensionality reduction technique</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – Normalize the features</p></li>
<li><p><strong>target_transform</strong> (<em>str</em>) – Transform the target values. Current options are
‘normalize’ (Normalize the values), ‘’ (Do nothing), ‘binarize’ (convert
the values using a threshold defined per dataset)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.ML_100K.df2coo">
<span class="sig-name descname"><span class="pre">df2coo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_data.html#ML_100K.df2coo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.ML_100K.df2coo" title="Permalink to this definition">#</a></dt>
<dd><p>Convert the input dataframe into a coo matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the target matrix information.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.ML_100K.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_data.html#ML_100K.load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.ML_100K.load_data" title="Permalink to this definition">#</a></dt>
<dd><p>Load dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – Path to the directory containing ML100K dataset</p></li>
<li><p><strong>e1_path</strong> (<em>str</em>) – Path to the file containing row (user) features of ML100K dataset</p></li>
<li><p><strong>e2_path</strong> (<em>str</em>) – Path to the file containing col (movie) features of ML100K dataset</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-recommenders.models.geoimc.geoimc_predict"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_predict.Inferer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_predict.</span></span><span class="sig-name descname"><span class="pre">Inferer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_predict.html#Inferer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_predict.Inferer" title="Permalink to this definition">#</a></dt>
<dd><p>Holds necessary (minimal) information needed for inference</p>
<p>Initialize parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – The inference method. Currently ‘dot’
(Dot product) is supported.</p></li>
<li><p><strong>k</strong> (<em>uint</em>) – <cite>k</cite> for ‘topk’ transformation.</p></li>
<li><p><strong>transformation</strong> (<em>str</em>) – Transform the inferred values into a
different scale. Currently ‘mean’ (Binarize the values
using mean of inferred matrix as the threshold), ‘topk’
(Pick Top-K inferred values per row and assign them 1,
setting rest of them to 0), ‘’ (No transformation) are
supported.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_predict.Inferer.infer">
<span class="sig-name descname"><span class="pre">infer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataPtr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_predict.html#Inferer.infer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_predict.Inferer.infer" title="Permalink to this definition">#</a></dt>
<dd><p>Main inference method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataPtr</strong> (<a class="reference internal" href="#recommenders.models.geoimc.geoimc_data.DataPtr" title="recommenders.models.geoimc.geoimc_data.DataPtr"><em>DataPtr</em></a>) – An object containing the X, Z features needed for inference</p></li>
<li><p><strong>W</strong> (<em>iterable</em>) – An iterable containing the U, B, V parametrized matrices.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_predict.PlainScalarProduct">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_predict.</span></span><span class="sig-name descname"><span class="pre">PlainScalarProduct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_predict.html#PlainScalarProduct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_predict.PlainScalarProduct" title="Permalink to this definition">#</a></dt>
<dd><p>Module that implements plain scalar product
as the retrieval criterion</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – numpy matrix of shape (users, features)</p></li>
<li><p><strong>Y</strong> – numpy matrix of shape (items, features)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_predict.PlainScalarProduct.sim">
<span class="sig-name descname"><span class="pre">sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_predict.html#PlainScalarProduct.sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_predict.PlainScalarProduct.sim" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the similarity score</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-recommenders.models.geoimc.geoimc_utils"></span><dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_utils.length_normalize">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_utils.</span></span><span class="sig-name descname"><span class="pre">length_normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_utils.html#length_normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_utils.length_normalize" title="Permalink to this definition">#</a></dt>
<dd><p>Length normalize the matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>matrix</strong> (<em>np.ndarray</em>) – Input matrix that needs to be normalized</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_utils.mean_center">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_utils.</span></span><span class="sig-name descname"><span class="pre">mean_center</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_utils.html#mean_center"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_utils.mean_center" title="Permalink to this definition">#</a></dt>
<dd><p>Performs mean centering across axis 0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>matrix</strong> (<em>np.ndarray</em>) – Input matrix that needs to be mean centered</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_utils.reduce_dims">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_utils.</span></span><span class="sig-name descname"><span class="pre">reduce_dims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/geoimc/geoimc_utils.html#reduce_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_utils.reduce_dims" title="Permalink to this definition">#</a></dt>
<dd><p>Reduce dimensionality of the data using PCA.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> (<em>np.ndarray</em>) – Matrix of the form (n_sampes, n_features)</p></li>
<li><p><strong>target_dim</strong> (<em>uint</em>) – Dimension to which n_features should be reduced to.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-recommenders.models.lightfm.lightfm_utils">
<span id="lightfm"></span><h2>LightFM<a class="headerlink" href="#module-recommenders.models.lightfm.lightfm_utils" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.compare_metric">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">compare_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prec'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'test'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightfm/lightfm_utils.html#compare_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.compare_metric" title="Permalink to this definition">#</a></dt>
<dd><p>Function to combine and prepare list of dataframes into tidy format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_list</strong> (<em>list</em>) – List of dataframes</p></li>
<li><p><strong>metrics</strong> (<em>str</em>) – name of metric to be extracted, optional</p></li>
<li><p><strong>stage</strong> (<em>str</em>) – name of model fitting stage to be extracted, optional</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Metrics</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.model_perf_plots">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">model_perf_plots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightfm/lightfm_utils.html#model_perf_plots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.model_perf_plots" title="Permalink to this definition">#</a></dt>
<dd><p>Function to plot model performance metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Dataframe in tidy format, with [‘epoch’,’level’,’value’] columns</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>matplotlib axes</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.prepare_all_predictions">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">prepare_all_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uid_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iid_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightfm/lightfm_utils.html#prepare_all_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.prepare_all_predictions" title="Permalink to this definition">#</a></dt>
<dd><p>Function to prepare all predictions for evaluation.
:param data: dataframe of all users, items and ratings as loaded
:type data: pandas df
:param uid_map: Keys to map internal user indices to external ids.
:type uid_map: dict
:param iid_map: Keys to map internal item indices to external ids.
:type iid_map: dict
:param interactions: user-item interaction
:type interactions: np.float32 coo_matrix
:param model: fitted LightFM model
:type model: LightFM instance
:param num_threads: number of parallel computation threads
:type num_threads: int
:param user_features: User weights over features
:type user_features: np.float32 csr_matrix
:param item_features: Item weights over features
:type item_features: np.float32 csr_matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>all predictions</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.prepare_test_df">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">prepare_test_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uid_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iid_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightfm/lightfm_utils.html#prepare_test_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.prepare_test_df" title="Permalink to this definition">#</a></dt>
<dd><p>Function to prepare test df for evaluation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_idx</strong> (<em>slice</em>) – slice of test indices</p></li>
<li><p><strong>uids</strong> (<em>numpy.ndarray</em>) – Array of internal user indices</p></li>
<li><p><strong>iids</strong> (<em>numpy.ndarray</em>) – Array of internal item indices</p></li>
<li><p><strong>uid_map</strong> (<em>dict</em>) – Keys to map internal user indices to external ids.</p></li>
<li><p><strong>iid_map</strong> (<em>dict</em>) – Keys to map internal item indices to external ids.</p></li>
<li><p><strong>weights</strong> (<em>numpy.float32 coo_matrix</em>) – user-item interaction</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>user-item selected for testing</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.similar_items">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">similar_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightfm/lightfm_utils.html#similar_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.similar_items" title="Permalink to this definition">#</a></dt>
<dd><p>Function to return top N similar items
based on <a class="github reference external" href="https://github.com/lyst/lightfm/issues/244#issuecomment-355305681">lyst/lightfm#244</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item_id</strong> (<em>int</em>) – id of item to be used as reference</p></li>
<li><p><strong>item_features</strong> (<em>scipy sparse CSR matrix</em>) – item feature matric</p></li>
<li><p><strong>model</strong> (<em>LightFM instance</em>) – fitted LightFM model</p></li>
<li><p><strong>N</strong> (<em>int</em>) – Number of top similar items to return</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>top N most similar items with score</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.similar_users">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">similar_users</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightfm/lightfm_utils.html#similar_users"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.similar_users" title="Permalink to this definition">#</a></dt>
<dd><p>Function to return top N similar users based on <a class="github reference external" href="https://github.com/lyst/lightfm/issues/244#issuecomment-355305681">lyst/lightfm#244</a></p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>user_id (int): id of user to be used as reference
user_features (scipy sparse CSR matrix): user feature matric
model (LightFM instance): fitted LightFM model
N (int): Number of top similar users to return</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>top N most similar users with score</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.track_model_metrics">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">track_model_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_interactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_interactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightfm/lightfm_utils.html#track_model_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.track_model_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Function to record model’s performance at each epoch, formats the performance into tidy format,
plots the performance and outputs the performance data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>LightFM instance</em>) – fitted LightFM model</p></li>
<li><p><strong>train_interactions</strong> (<em>scipy sparse COO matrix</em>) – train interactions set</p></li>
<li><p><strong>test_interactions</strong> (<em>scipy sparse COO matrix</em>) – test interaction set</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of recommendations, optional</p></li>
<li><p><strong>no_epochs</strong> (<em>int</em>) – Number of epochs to run, optional</p></li>
<li><p><strong>no_threads</strong> (<em>int</em>) – Number of parallel threads to use, optional</p></li>
<li><p><strong>**kwargs</strong> – other keyword arguments to be passed down</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Performance traces of the fitted model</p></li>
<li><p>Fitted model</p></li>
<li><p>Side effect of the method</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame, LightFM model, matplotlib axes</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-recommenders.models.lightgbm.lightgbm_utils">
<span id="lightgbm"></span><h2>LightGBM<a class="headerlink" href="#module-recommenders.models.lightgbm.lightgbm_utils" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.lightgbm.lightgbm_utils.NumEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.lightgbm.lightgbm_utils.</span></span><span class="sig-name descname"><span class="pre">NumEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cate_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nume_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightgbm/lightgbm_utils.html#NumEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightgbm.lightgbm_utils.NumEncoder" title="Permalink to this definition">#</a></dt>
<dd><p>Encode all the categorical features into numerical ones by sequential label encoding, sequential count encoding,
and binary encoding. Additionally, it also filters the low-frequency categories and fills the missing values.</p>
<p>Constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cate_cols</strong> (<em>list</em>) – The columns of categorical features.</p></li>
<li><p><strong>nume_cols</strong> (<em>list</em>) – The columns of numerical features.</p></li>
<li><p><strong>label_col</strong> (<em>object</em>) – The column of Label.</p></li>
<li><p><strong>threshold</strong> (<em>int</em>) – The categories whose frequency is lower than the threshold will be filtered (be treated
as “&lt;LESS&gt;”).</p></li>
<li><p><strong>thresrate</strong> (<em>float</em>) – The (1.0 - thersrate, default 1%) lowest-frequency categories will also be filtered.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.lightgbm.lightgbm_utils.NumEncoder.fit_transform">
<span class="sig-name descname"><span class="pre">fit_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightgbm/lightgbm_utils.html#NumEncoder.fit_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightgbm.lightgbm_utils.NumEncoder.fit_transform" title="Permalink to this definition">#</a></dt>
<dd><p>Input a training set (pandas.DataFrame) and return the converted 2 numpy.ndarray (x,y).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input dataframe</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New features and labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray, numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.lightgbm.lightgbm_utils.NumEncoder.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightgbm/lightgbm_utils.html#NumEncoder.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightgbm.lightgbm_utils.NumEncoder.transform" title="Permalink to this definition">#</a></dt>
<dd><p>Input a testing / validation set (pandas.DataFrame) and return the converted 2 numpy.ndarray (x,y).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input dataframe</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New features and labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray, numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightgbm.lightgbm_utils.unpackbits">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightgbm.lightgbm_utils.</span></span><span class="sig-name descname"><span class="pre">unpackbits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/lightgbm/lightgbm_utils.html#unpackbits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightgbm.lightgbm_utils.unpackbits" title="Permalink to this definition">#</a></dt>
<dd><p>Convert a decimal value numpy.ndarray into multi-binary value numpy.ndarray ([1,2]-&gt;[[0,1],[1,0]])</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – Decimal array.</p></li>
<li><p><strong>num_bits</strong> (<em>int</em>) – The max length of the converted binary value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-recommenders.models.ncf.dataset">
<span id="ncf"></span><h2>NCF<a class="headerlink" href="#module-recommenders.models.ncf.dataset" title="Permalink to this heading">#</a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.EmptyFileException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.dataset.</span></span><span class="sig-name descname"><span class="pre">EmptyFileException</span></span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#EmptyFileException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.EmptyFileException" title="Permalink to this definition">#</a></dt>
<dd><p>Exception raised if file is empty</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.FileNotSortedException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.dataset.</span></span><span class="sig-name descname"><span class="pre">FileNotSortedException</span></span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#FileNotSortedException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.FileNotSortedException" title="Permalink to this definition">#</a></dt>
<dd><p>Exception raised if file is not sorted correctly</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.MissingFieldsException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.dataset.</span></span><span class="sig-name descname"><span class="pre">MissingFieldsException</span></span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#MissingFieldsException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.MissingFieldsException" title="Permalink to this definition">#</a></dt>
<dd><p>Exception raised if file is missing expected fields</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.MissingUserException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.dataset.</span></span><span class="sig-name descname"><span class="pre">MissingUserException</span></span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#MissingUserException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.MissingUserException" title="Permalink to this definition">#</a></dt>
<dd><p>Exception raised if user is not in file</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.DataFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.dataset.</span></span><span class="sig-name descname"><span class="pre">DataFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_test_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#DataFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.DataFile" title="Permalink to this definition">#</a></dt>
<dd><p>DataFile class for NCF. Iterator to read data from a csv file.
Data must be sorted by user. Includes utilities for loading user data from
file, formatting it and returning a Pandas dataframe.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – Path to file to be processed.</p></li>
<li><p><strong>col_user</strong> (<em>str</em>) – User column name.</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – Item column name.</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – Rating column name.</p></li>
<li><p><strong>col_test_batch</strong> (<em>str</em>) – Test batch column name.</p></li>
<li><p><strong>binary</strong> (<em>bool</em>) – If true, set rating &gt; 0 to rating = 1.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.DataFile.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#DataFile.load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.DataFile.load_data" title="Permalink to this definition">#</a></dt>
<dd><p>Load data for a specified user or test batch</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>int</em>) – user or test batch index</p></li>
<li><p><strong>by_user</strong> (<em>bool</em>) – load data by usr if True, else by test batch</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.Dataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.dataset.</span></span><span class="sig-name descname"><span class="pre">Dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_file_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_test_file_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neg_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_with_replacement</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#Dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.Dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Dataset class for NCF</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_file</strong> (<em>str</em>) – Path to training dataset file.</p></li>
<li><p><strong>test_file</strong> (<em>str</em>) – Path to test dataset file for leave-one-out evaluation.</p></li>
<li><p><strong>test_file_full</strong> (<em>str</em>) – Path to full test dataset file including negative samples.</p></li>
<li><p><strong>overwrite_test_file_full</strong> (<em>bool</em>) – If true, recreate and overwrite test_file_full.</p></li>
<li><p><strong>n_neg</strong> (<em>int</em>) – Number of negative samples per positive example for training set.</p></li>
<li><p><strong>n_neg_test</strong> (<em>int</em>) – Number of negative samples per positive example for test set.</p></li>
<li><p><strong>col_user</strong> (<em>str</em>) – User column name.</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – Item column name.</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – Rating column name.</p></li>
<li><p><strong>binary</strong> (<em>bool</em>) – If true, set rating &gt; 0 to rating = 1.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed.</p></li>
<li><p><strong>sample_with_replacement</strong> (<em>bool</em>) – If true, sample negative examples with replacement,
otherwise without replacement.</p></li>
<li><p><strong>print_warnings</strong> (<em>bool</em>) – If true, prints warnings if sampling without replacement and
there are not enough items to sample from to satisfy n_neg or n_neg_test.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.Dataset.test_loader">
<span class="sig-name descname"><span class="pre">test_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yield_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#Dataset.test_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.Dataset.test_loader" title="Permalink to this definition">#</a></dt>
<dd><p>Generator for serving batches of test data for leave-one-out evaluation. Data is loaded from test_file_full.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>yield_id</strong> (<em>bool</em>) – If true, return assigned user and item IDs, else return original values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.Dataset.train_loader">
<span class="sig-name descname"><span class="pre">train_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yield_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#Dataset.train_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.Dataset.train_loader" title="Permalink to this definition">#</a></dt>
<dd><p>Generator for serving batches of training data. Positive examples are loaded from the
original training file, to which negative samples are added. Data is loaded in memory into a
shuffle buffer up to a maximum of shuffle_size rows, before the data is shuffled and released.
If out-of-memory errors are encountered, try reducing shuffle_size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em>) – Number of examples in each batch.</p></li>
<li><p><strong>shuffle_size</strong> (<em>int</em>) – Maximum number of examples in shuffle buffer.</p></li>
<li><p><strong>yield_id</strong> (<em>bool</em>) – If true, return assigned user and item IDs, else return original values.</p></li>
<li><p><strong>write_to</strong> (<em>str</em>) – Path of file to write full dataset (including negative examples).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.NegativeSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.dataset.</span></span><span class="sig-name descname"><span class="pre">NegativeSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_positive_item_pool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_pool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_with_replacement</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#NegativeSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.NegativeSampler" title="Permalink to this definition">#</a></dt>
<dd><p>NegativeSampler class for NCF. Samples a subset of negative items from a given population of items.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user</strong> (<em>str</em><em> or </em><em>int</em>) – User to be sampled for.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of required samples.</p></li>
<li><p><strong>user_positive_item_pool</strong> (<em>set</em>) – Set of items with which user has previously interacted.</p></li>
<li><p><strong>item_pool</strong> (<em>set</em>) – Set of all items in population.</p></li>
<li><p><strong>sample_with_replacement</strong> (<em>bool</em>) – If true, sample negative examples with replacement,
otherwise without replacement.</p></li>
<li><p><strong>print_warnings</strong> (<em>bool</em>) – If true, prints warnings if sampling without replacement and
there are not enough items to sample from to satisfy n_neg or n_neg_test.</p></li>
<li><p><strong>training</strong> (<em>bool</em>) – Set to true if sampling for the training set or false if for the test set.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.NegativeSampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/ncf/dataset.html#NegativeSampler.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.NegativeSampler.sample" title="Permalink to this definition">#</a></dt>
<dd><p>Method for sampling uniformly from a population of negative items</p>
<p>Returns: list</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.newsrec.newsrec_utils">
<span id="newsrec"></span><h2>NewsRec<a class="headerlink" href="#module-recommenders.models.newsrec.newsrec_utils" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.check_nn_config">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">check_nn_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/newsrec_utils.html#check_nn_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.check_nn_config" title="Permalink to this definition">#</a></dt>
<dd><p>Check neural networks configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f_config</strong> (<em>dict</em>) – Neural network configuration.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the parameters are not correct.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.check_type">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">check_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/newsrec_utils.html#check_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.check_type" title="Permalink to this definition">#</a></dt>
<dd><p>Check that the config parameters are the correct type</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Configuration dictionary.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – If the parameters are not the correct type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.create_hparams">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">create_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/newsrec_utils.html#create_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.create_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Create the model hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>flags</strong> (<em>dict</em>) – Dictionary with the model requirements.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hyperparameter object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#recommenders.models.deeprec.deeprec_utils.HParams" title="recommenders.models.deeprec.deeprec_utils.HParams">HParams</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.get_mind_data_set">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">get_mind_data_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/newsrec_utils.html#get_mind_data_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.get_mind_data_set" title="Permalink to this definition">#</a></dt>
<dd><p>Get MIND dataset address</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>type</strong> (<em>str</em>) – type of mind dataset, must be in [‘large’, ‘small’, ‘demo’]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>data url and train valid dataset name</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.newsample">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">newsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/newsrec_utils.html#newsample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.newsample" title="Permalink to this definition">#</a></dt>
<dd><p>Sample ratio samples from news list.
If length of news is less than ratio, pad zeros.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>news</strong> (<em>list</em>) – input news list</p></li>
<li><p><strong>ratio</strong> (<em>int</em>) – sample number</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of sample list.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.prepare_hparams">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">prepare_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yaml_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/newsrec_utils.html#prepare_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.prepare_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the model hyperparameters and check that all have the correct value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>yaml_file</strong> (<em>str</em>) – YAML file as configuration.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hyperparameter object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#recommenders.models.deeprec.deeprec_utils.HParams" title="recommenders.models.deeprec.deeprec_utils.HParams">HParams</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.word_tokenize">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">word_tokenize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sent</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/newsrec/newsrec_utils.html#word_tokenize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.word_tokenize" title="Permalink to this definition">#</a></dt>
<dd><p>Split sentence into word list using regex.
:param sent: Input sentence
:type sent: str</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>word list</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="rbm">
<h2>RBM<a class="headerlink" href="#rbm" title="Permalink to this heading">#</a></h2>
</section>
<section id="module-recommenders.models.rlrmc.RLRMCdataset">
<span id="rlrmc"></span><h2>RLRMC<a class="headerlink" href="#module-recommenders.models.rlrmc.RLRMCdataset" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.rlrmc.RLRMCdataset.RLRMCdataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.rlrmc.RLRMCdataset.</span></span><span class="sig-name descname"><span class="pre">RLRMCdataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'timestamp'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/rlrmc/RLRMCdataset.html#RLRMCdataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rlrmc.RLRMCdataset.RLRMCdataset" title="Permalink to this definition">#</a></dt>
<dd><p>RLRMC dataset implementation. Creates sparse data structures for RLRMC algorithm.</p>
<p>Initialize parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>pandas.DataFrame</strong> (<em>train</em>) – training data with at least columns (col_user, col_item, col_rating)</p></li>
<li><p><strong>validation</strong> (<em>pandas.DataFrame</em>) – validation data with at least columns (col_user, col_item, col_rating). validation can be None, if so, we only process the training data</p></li>
<li><p><strong>mean_center</strong> (<em>bool</em>) – flag to mean center the ratings in train (and validation) data</p></li>
<li><p><strong>col_user</strong> (<em>str</em>) – user column name</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – item column name</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – rating column name</p></li>
<li><p><strong>col_timestamp</strong> (<em>str</em>) – timestamp column name</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-recommenders.models.sar.sar_singlenode">
<span id="sar"></span><h2>SAR<a class="headerlink" href="#module-recommenders.models.sar.sar_singlenode" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.sar.sar_singlenode.</span></span><span class="sig-name descname"><span class="pre">SARSingleNode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'timestamp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_prediction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jaccard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_decay_coefficient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_now</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timedecay_formula</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode" title="Permalink to this definition">#</a></dt>
<dd><p>Simple Algorithm for Recommendations (SAR) implementation</p>
<p>SAR is a fast scalable adaptive algorithm for personalized recommendations based on user transaction history
and items description. The core idea behind SAR is to recommend items like those that a user already has
demonstrated an affinity to. It does this by 1) estimating the affinity of users for items, 2) estimating
similarity across items, and then 3) combining the estimates to generate a set of recommendations for a given user.</p>
<p>Initialize model parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col_user</strong> (<em>str</em>) – user column name</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – item column name</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – rating column name</p></li>
<li><p><strong>col_timestamp</strong> (<em>str</em>) – timestamp column name</p></li>
<li><p><strong>col_prediction</strong> (<em>str</em>) – prediction column name</p></li>
<li><p><strong>similarity_type</strong> (<em>str</em>) – [‘cooccurrence’, ‘cosine’, ‘inclusion index’, ‘jaccard’,
‘lexicographers mutual information’, ‘lift’, ‘mutual information’] option for
computing item-item similarity</p></li>
<li><p><strong>time_decay_coefficient</strong> (<em>float</em>) – number of days till ratings are decayed by 1/2</p></li>
<li><p><strong>time_now</strong> (<em>int</em><em> | </em><em>None</em>) – current time for time decay calculation</p></li>
<li><p><strong>timedecay_formula</strong> (<em>bool</em>) – flag to apply time decay</p></li>
<li><p><strong>threshold</strong> (<em>int</em>) – item-item co-occurrences below this threshold will be removed</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – option for normalizing predictions to scale of original ratings</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.compute_affinity_matrix">
<span class="sig-name descname"><span class="pre">compute_affinity_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rating_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.compute_affinity_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.compute_affinity_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Affinity matrix.</p>
<p>The user-affinity matrix can be constructed by treating the users and items as
indices in a sparse matrix, and the events as the data. Here, we’re treating
the ratings as the event weights.  We convert between different sparse-matrix
formats to de-duplicate user-item pairs, otherwise they will get added up.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Indexed df of users and items</p></li>
<li><p><strong>rating_col</strong> (<em>str</em>) – Name of column to use for ratings</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Affinity matrix in Compressed Sparse Row (CSR) format.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sparse.csr</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.compute_cooccurrence_matrix">
<span class="sig-name descname"><span class="pre">compute_cooccurrence_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.compute_cooccurrence_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.compute_cooccurrence_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Co-occurrence matrix.</p>
<p>The co-occurrence matrix is defined as <span class="math notranslate nohighlight">\(C = U^T * U\)</span></p>
<p>where U is the user_affinity matrix with 1’s as values (instead of ratings).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame of users and items</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Co-occurrence matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.compute_time_decay">
<span class="sig-name descname"><span class="pre">compute_time_decay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_column</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.compute_time_decay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.compute_time_decay" title="Permalink to this definition">#</a></dt>
<dd><p>Compute time decay on provided column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame of users and items</p></li>
<li><p><strong>decay_column</strong> (<em>str</em>) – column to decay</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>with column decayed</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Main fit method for SAR.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please make sure that <cite>df</cite> has no duplicates.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – User item rating dataframe (without duplicates).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.get_item_based_topk">
<span class="sig-name descname"><span class="pre">get_item_based_topk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.get_item_based_topk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.get_item_based_topk" title="Permalink to this definition">#</a></dt>
<dd><p>Get top K similar items to provided seed items based on similarity metric defined.
This method will take a set of items and use them to recommend the most similar items to that set
based on the similarity matrix fit during training.
This allows recommendations for cold-users (unseen during training), note - the model is not updated.</p>
<p>The following options are possible based on information provided in the items input:
1. Single user or seed of items: only item column (ratings are assumed to be 1)
2. Single user or seed of items w/ ratings: item column and rating column
3. Separate users or seeds of items: item and user column (user ids are only used to separate item sets)
4. Separate users or seeds of items with ratings: item, user and rating columns provided</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>items</strong> (<em>pandas.DataFrame</em>) – DataFrame with item, user (optional), and rating (optional) columns</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – number of top items to recommend</p></li>
<li><p><strong>sort_top_k</strong> (<em>bool</em>) – flag to sort top k results</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>sorted top k recommendation items</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.get_popularity_based_topk">
<span class="sig-name descname"><span class="pre">get_popularity_based_topk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.get_popularity_based_topk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.get_popularity_based_topk" title="Permalink to this definition">#</a></dt>
<dd><p>Get top K most frequently occurring items across all users.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>top_k</strong> (<em>int</em>) – number of top items to recommend.</p></li>
<li><p><strong>sort_top_k</strong> (<em>bool</em>) – flag to sort top k results.</p></li>
<li><p><strong>items</strong> (<em>bool</em>) – if false, return most frequent users instead</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>top k most popular items.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.get_topk_most_similar_users">
<span class="sig-name descname"><span class="pre">get_topk_most_similar_users</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.get_topk_most_similar_users"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.get_topk_most_similar_users" title="Permalink to this definition">#</a></dt>
<dd><p>Based on user affinity towards items, calculate the most similar users to the given user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user</strong> (<em>int</em>) – user to retrieve most similar users for</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – number of top items to recommend</p></li>
<li><p><strong>sort_top_k</strong> (<em>bool</em>) – flag to sort top k results</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>top k most similar users and their scores</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Output SAR scores for only the users-items pairs which are in the test set</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>test</strong> (<em>pandas.DataFrame</em>) – DataFrame that contains users and items to test</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame contains the prediction results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.recommend_k_items">
<span class="sig-name descname"><span class="pre">recommend_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.recommend_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.recommend_k_items" title="Permalink to this definition">#</a></dt>
<dd><p>Recommend top K items for all users which are in the test set</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test</strong> (<em>pandas.DataFrame</em>) – users to test</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – number of top items to recommend</p></li>
<li><p><strong>sort_top_k</strong> (<em>bool</em>) – flag to sort top k results</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – flag to remove items seen in training from recommendation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>top k recommendation items for each user</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.score" title="Permalink to this definition">#</a></dt>
<dd><p>Score all items for test users.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test</strong> (<em>pandas.DataFrame</em>) – user to test</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – flag to remove items seen in training from recommendation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of interest of all items for the users.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.set_index">
<span class="sig-name descname"><span class="pre">set_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.set_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.set_index" title="Permalink to this definition">#</a></dt>
<dd><p>Generate continuous indices for users and items to reduce memory usage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – dataframe with user and item ids</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-recommenders.models.sasrec.sampler">
<span id="sasrec"></span><h2>SASRec<a class="headerlink" href="#module-recommenders.models.sasrec.sampler" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.WarpSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.sasrec.sampler.</span></span><span class="sig-name descname"><span class="pre">WarpSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">User</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usernum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemnum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/sampler.html#WarpSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.sampler.WarpSampler" title="Permalink to this definition">#</a></dt>
<dd><p>Sampler object that creates an iterator for feeding batch data while training.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.WarpSampler.User">
<span class="sig-name descname"><span class="pre">User</span></span><a class="headerlink" href="#recommenders.models.sasrec.sampler.WarpSampler.User" title="Permalink to this definition">#</a></dt>
<dd><p>dict, all the users (keys) with items as values</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.WarpSampler.usernum">
<span class="sig-name descname"><span class="pre">usernum</span></span><a class="headerlink" href="#recommenders.models.sasrec.sampler.WarpSampler.usernum" title="Permalink to this definition">#</a></dt>
<dd><p>integer, total number of users</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.WarpSampler.itemnum">
<span class="sig-name descname"><span class="pre">itemnum</span></span><a class="headerlink" href="#recommenders.models.sasrec.sampler.WarpSampler.itemnum" title="Permalink to this definition">#</a></dt>
<dd><p>integer, total number of items</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.WarpSampler.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><a class="headerlink" href="#recommenders.models.sasrec.sampler.WarpSampler.batch_size" title="Permalink to this definition">#</a></dt>
<dd><p>batch size</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.WarpSampler.maxlen">
<span class="sig-name descname"><span class="pre">maxlen</span></span><a class="headerlink" href="#recommenders.models.sasrec.sampler.WarpSampler.maxlen" title="Permalink to this definition">#</a></dt>
<dd><p>maximum input sequence length</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.WarpSampler.n_workers">
<span class="sig-name descname"><span class="pre">n_workers</span></span><a class="headerlink" href="#recommenders.models.sasrec.sampler.WarpSampler.n_workers" title="Permalink to this definition">#</a></dt>
<dd><p>number of workers for parallel execution</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.sasrec.sampler.sample_function">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.sasrec.sampler.</span></span><span class="sig-name descname"><span class="pre">sample_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usernum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemnum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_queue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/sampler.html#sample_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.sampler.sample_function" title="Permalink to this definition">#</a></dt>
<dd><p>Batch sampler that creates a sequence of negative items based on the
original sequence of items (positive) that the user has interacted with.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_train</strong> (<em>dict</em>) – dictionary of training exampled for each user</p></li>
<li><p><strong>usernum</strong> (<em>int</em>) – number of users</p></li>
<li><p><strong>itemnum</strong> (<em>int</em>) – number of items</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – batch size</p></li>
<li><p><strong>maxlen</strong> (<em>int</em>) – maximum input sequence length</p></li>
<li><p><strong>result_queue</strong> (<em>multiprocessing.Queue</em>) – queue for storing sample results</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – seed for random generator</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-recommenders.models.sasrec.util"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.sasrec.util.</span></span><span class="sig-name descname"><span class="pre">SASRecDataSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/sasrec/util.html#SASRecDataSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet" title="Permalink to this definition">#</a></dt>
<dd><p>A class for creating SASRec specific dataset used during
train, validation and testing.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.usernum">
<span class="sig-name descname"><span class="pre">usernum</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.usernum" title="Permalink to this definition">#</a></dt>
<dd><p>integer, total number of users</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.itemnum">
<span class="sig-name descname"><span class="pre">itemnum</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.itemnum" title="Permalink to this definition">#</a></dt>
<dd><p>integer, total number of items</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.User">
<span class="sig-name descname"><span class="pre">User</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.User" title="Permalink to this definition">#</a></dt>
<dd><p>dict, all the users (keys) with items as values</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.Items">
<span class="sig-name descname"><span class="pre">Items</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.Items" title="Permalink to this definition">#</a></dt>
<dd><p>set of all the items</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.user_train">
<span class="sig-name descname"><span class="pre">user_train</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.user_train" title="Permalink to this definition">#</a></dt>
<dd><p>dict, subset of User that are used for training</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.user_valid">
<span class="sig-name descname"><span class="pre">user_valid</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.user_valid" title="Permalink to this definition">#</a></dt>
<dd><p>dict, subset of User that are used for validation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.user_test">
<span class="sig-name descname"><span class="pre">user_test</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.user_test" title="Permalink to this definition">#</a></dt>
<dd><p>dict, subset of User that are used for testing</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.col_sep">
<span class="sig-name descname"><span class="pre">col_sep</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.col_sep" title="Permalink to this definition">#</a></dt>
<dd><p>column separator in the data file</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.sasrec.util.SASRecDataSet.filename">
<span class="sig-name descname"><span class="pre">filename</span></span><a class="headerlink" href="#recommenders.models.sasrec.util.SASRecDataSet.filename" title="Permalink to this definition">#</a></dt>
<dd><p>data filename</p>
</dd></dl>

</dd></dl>

</section>
<section id="sse-pt">
<h2>SSE-PT<a class="headerlink" href="#sse-pt" title="Permalink to this heading">#</a></h2>
</section>
<section id="module-recommenders.models.surprise.surprise_utils">
<span id="surprise"></span><h2>Surprise<a class="headerlink" href="#module-recommenders.models.surprise.surprise_utils" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.surprise.surprise_utils.compute_ranking_predictions">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.surprise.surprise_utils.</span></span><span class="sig-name descname"><span class="pre">compute_ranking_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usercol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/surprise/surprise_utils.html#compute_ranking_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.surprise.surprise_utils.compute_ranking_predictions" title="Permalink to this definition">#</a></dt>
<dd><p>Computes predictions of an algorithm from Surprise on all users and items in data. It can be used for computing
ranking metrics like NDCG.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>algo</strong> (<em>surprise.prediction_algorithms.algo_base.AlgoBase</em>) – an algorithm from Surprise</p></li>
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – the data from which to get the users and items</p></li>
<li><p><strong>usercol</strong> (<em>str</em>) – name of the user column</p></li>
<li><p><strong>itemcol</strong> (<em>str</em>) – name of the item column</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – flag to remove (user, item) pairs seen in the training data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with usercol, itemcol, predcol</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.surprise.surprise_utils.predict">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.surprise.surprise_utils.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usercol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/surprise/surprise_utils.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.surprise.surprise_utils.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Computes predictions of an algorithm from Surprise on the data. Can be used for computing rating metrics like RMSE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>algo</strong> (<em>surprise.prediction_algorithms.algo_base.AlgoBase</em>) – an algorithm from Surprise</p></li>
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – the data on which to predict</p></li>
<li><p><strong>usercol</strong> (<em>str</em>) – name of the user column</p></li>
<li><p><strong>itemcol</strong> (<em>str</em>) – name of the item column</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with usercol, itemcol, predcol</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.surprise.surprise_utils.surprise_trainset_to_df">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.surprise.surprise_utils.</span></span><span class="sig-name descname"><span class="pre">surprise_trainset_to_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'uid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/surprise/surprise_utils.html#surprise_trainset_to_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.surprise.surprise_utils.surprise_trainset_to_df" title="Permalink to this definition">#</a></dt>
<dd><p>Converts a <cite>surprise.Trainset</cite> object to <cite>pandas.DataFrame</cite></p>
<p>More info: <a class="reference external" href="https://surprise.readthedocs.io/en/stable/trainset.html">https://surprise.readthedocs.io/en/stable/trainset.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainset</strong> (<em>object</em>) – A surprise.Trainset object.</p></li>
<li><p><strong>col_user</strong> (<em>str</em>) – User column name.</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – Item column name.</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – Rating column name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe with user column (str), item column (str), and rating column (float).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-recommenders.models.tfidf.tfidf_utils">
<span id="tf-idf"></span><h2>TF-IDF<a class="headerlink" href="#module-recommenders.models.tfidf.tfidf_utils" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.tfidf.tfidf_utils.</span></span><span class="sig-name descname"><span class="pre">TfidfRecommender</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenization_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scibert'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender" title="Permalink to this definition">#</a></dt>
<dd><p>Term Frequency - Inverse Document Frequency (TF-IDF) Recommender</p>
<p>This class provides content-based recommendations using TF-IDF vectorization in combination with cosine similarity.</p>
<p>Initialize model parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id_col</strong> (<em>str</em>) – Name of column containing item IDs.</p></li>
<li><p><strong>tokenization_method</strong> (<em>str</em>) – [‘none’,’nltk’,’bert’,’scibert’] option for tokenization method.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.clean_dataframe">
<span class="sig-name descname"><span class="pre">clean_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols_to_clean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_col_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cleaned_text'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.clean_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.clean_dataframe" title="Permalink to this definition">#</a></dt>
<dd><p>Clean the text within the columns of interest and return a dataframe with cleaned and combined text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Dataframe containing the text content to clean.</p></li>
<li><p><strong>cols_to_clean</strong> (<em>list of str</em>) – List of columns to clean by name (e.g., [‘abstract’,’full_text’]).</p></li>
<li><p><strong>new_col_name</strong> (<em>str</em>) – Name of the new column that will contain the cleaned text.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with cleaned text in the new column.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectors_tokenized</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Fit TF-IDF vectorizer to the cleaned and tokenized text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tf</strong> (<em>TfidfVectorizer</em>) – sklearn.feature_extraction.text.TfidfVectorizer object defined in .tokenize_text().</p></li>
<li><p><strong>vectors_tokenized</strong> (<em>pandas.Series</em>) – Each row contains tokens for respective documents separated by spaces.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_stop_words">
<span class="sig-name descname"><span class="pre">get_stop_words</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.get_stop_words"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_stop_words" title="Permalink to this definition">#</a></dt>
<dd><p>Return the stop words excluded in the TF-IDF vectorizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Frozenset of stop words used by the TF-IDF vectorizer (can be converted to list).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_tokens">
<span class="sig-name descname"><span class="pre">get_tokens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.get_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_tokens" title="Permalink to this definition">#</a></dt>
<dd><p>Return the tokens generated by the TF-IDF vectorizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of tokens generated by the TF-IDF vectorizer.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_top_k_recommendations">
<span class="sig-name descname"><span class="pre">get_top_k_recommendations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols_to_keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.get_top_k_recommendations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_top_k_recommendations" title="Permalink to this definition">#</a></dt>
<dd><p>Return the top k recommendations with useful metadata for each recommendation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metadata</strong> (<em>pandas.DataFrame</em>) – Dataframe holding metadata for all public domain papers.</p></li>
<li><p><strong>query_id</strong> (<em>str</em>) – ID of item of interest.</p></li>
<li><p><strong>cols_to_keep</strong> (<em>list of str</em>) – List of columns from the metadata dataframe to include
(e.g., [‘title’,’authors’,’journal’,’publish_time’,’url’]).
By default, all columns are kept.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – Set to True if you want to print the table.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stylized dataframe holding recommendations and associated metadata just for the item of interest (can access as normal dataframe by using df.data).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.Styler</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.recommend_top_k_items">
<span class="sig-name descname"><span class="pre">recommend_top_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_clean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.recommend_top_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.recommend_top_k_items" title="Permalink to this definition">#</a></dt>
<dd><p>Recommend k number of items similar to the item of interest.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_clean</strong> (<em>pandas.DataFrame</em>) – Dataframe with cleaned text.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – Number of recommendations to return.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe containing id of top k recommendations for all items.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.tokenize_text">
<span class="sig-name descname"><span class="pre">tokenize_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_clean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cleaned_text'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngram_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.tokenize_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.tokenize_text" title="Permalink to this definition">#</a></dt>
<dd><p>Tokenize the input text.
For more details on the TfidfVectorizer, see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html">https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_clean</strong> (<em>pandas.DataFrame</em>) – Dataframe with cleaned text in the new column.</p></li>
<li><p><strong>text_col</strong> (<em>str</em>) – Name of column containing the cleaned text.</p></li>
<li><p><strong>ngram_range</strong> (<em>tuple of int</em>) – The lower and upper boundary of the range of n-values for different n-grams to be extracted.</p></li>
<li><p><strong>min_df</strong> (<em>int</em>) – When building the vocabulary ignore terms that have a document frequency strictly lower than the given threshold.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Scikit-learn TfidfVectorizer object defined in <cite>.tokenize_text()</cite>.</p></li>
<li><p>Each row contains tokens for respective documents separated by spaces.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>TfidfVectorizer, pandas.Series</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="vae">
<h2>VAE<a class="headerlink" href="#vae" title="Permalink to this heading">#</a></h2>
</section>
<section id="module-recommenders.models.vowpal_wabbit.vw">
<span id="vowpal-wabbit"></span><h2>Vowpal Wabbit<a class="headerlink" href="#module-recommenders.models.vowpal_wabbit.vw" title="Permalink to this heading">#</a></h2>
<p>This file provides a wrapper to run Vowpal Wabbit from the command line through python.
It is not recommended to use this approach in production, there are python bindings that can be installed from the
repository or pip or the command line can be used. This is merely to demonstrate vw usage in the example notebooks.</p>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vowpal_wabbit.vw.VW">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vowpal_wabbit.vw.</span></span><span class="sig-name descname"><span class="pre">VW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'timestamp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_prediction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vowpal_wabbit/vw.html#VW"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vowpal_wabbit.vw.VW" title="Permalink to this definition">#</a></dt>
<dd><p>Vowpal Wabbit Class</p>
<p>Initialize model parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col_user</strong> (<em>str</em>) – user column name</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – item column name</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – rating column name</p></li>
<li><p><strong>col_timestamp</strong> (<em>str</em>) – timestamp column name</p></li>
<li><p><strong>col_prediction</strong> (<em>str</em>) – prediction column name</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vowpal_wabbit.vw.VW.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vowpal_wabbit/vw.html#VW.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vowpal_wabbit.vw.VW.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Train model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – input training data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vowpal_wabbit.vw.VW.parse_test_params">
<span class="sig-name descname"><span class="pre">parse_test_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vowpal_wabbit/vw.html#VW.parse_test_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vowpal_wabbit.vw.VW.parse_test_params" title="Permalink to this definition">#</a></dt>
<dd><p>Parse input hyper-parameters to build vw test commands</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<em>dict</em>) – key = parameter, value = value (use True if parameter is just a flag)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>vw command line parameters as list of strings</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vowpal_wabbit.vw.VW.parse_train_params">
<span class="sig-name descname"><span class="pre">parse_train_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vowpal_wabbit/vw.html#VW.parse_train_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vowpal_wabbit.vw.VW.parse_train_params" title="Permalink to this definition">#</a></dt>
<dd><p>Parse input hyper-parameters to build vw train commands</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<em>dict</em>) – key = parameter, value = value (use True if parameter is just a flag)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>vw command line parameters as list of strings</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vowpal_wabbit.vw.VW.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vowpal_wabbit/vw.html#VW.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vowpal_wabbit.vw.VW.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predict results</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – input test data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vowpal_wabbit.vw.VW.to_vw_cmd">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">to_vw_cmd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vowpal_wabbit/vw.html#VW.to_vw_cmd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vowpal_wabbit.vw.VW.to_vw_cmd" title="Permalink to this definition">#</a></dt>
<dd><p>Convert dictionary of parameters to vw command line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<em>dict</em>) – key = parameter, value = value (use True if parameter is just a flag)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>vw command line parameters as list of strings</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vowpal_wabbit.vw.VW.to_vw_file">
<span class="sig-name descname"><span class="pre">to_vw_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/recommenders/models/vowpal_wabbit/vw.html#VW.to_vw_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vowpal_wabbit.vw.VW.to_vw_file" title="Permalink to this definition">#</a></dt>
<dd><p>Convert Pandas DataFrame to vw input format file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – input DataFrame</p></li>
<li><p><strong>train</strong> (<em>bool</em>) – flag for train mode (or test mode if False)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="wide-deep">
<h2>Wide &amp; Deep<a class="headerlink" href="#wide-deep" title="Permalink to this heading">#</a></h2>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="evaluation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Evaluation module</p>
      </div>
    </a>
    <a class="right-next"
       href="tuning.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Hyperparameter tuning module</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.cornac.cornac_utils">Cornac</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deeprec">DeepRec</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#base-model">Base model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dkn">DKN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dkn-item-to-item">DKN item-to-item</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xdeepfm">xDeepFM</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lightgcn">LightGCN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sequential-models">Sequential models</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sequential-base-model">Sequential base model</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a2svd">A2SVD</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#caser">Caser</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gru">GRU</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nextitnet">NextItNet</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#rnn-cells">RNN Cells</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sum">SUM</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#slirec">SLIRec</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iterators">Iterators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.DataModel.ImplicitCF">Data processing utilities</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.deeprec.deeprec_utils">Utilities</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fastai">FastAI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.geoimc.geoimc_data">GeoIMC</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.lightfm.lightfm_utils">LightFM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.lightgbm.lightgbm_utils">LightGBM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.ncf.dataset">NCF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.newsrec.newsrec_utils">NewsRec</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rbm">RBM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.rlrmc.RLRMCdataset">RLRMC</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.sar.sar_singlenode">SAR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.sasrec.sampler">SASRec</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sse-pt">SSE-PT</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.surprise.surprise_utils">Surprise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.tfidf.tfidf_utils">TF-IDF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vae">VAE</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-recommenders.models.vowpal_wabbit.vw">Vowpal Wabbit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wide-deep">Wide &amp; Deep</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Recommenders contributors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>